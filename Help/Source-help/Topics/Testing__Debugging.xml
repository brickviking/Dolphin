<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../helpproject.xsl" ?>
<topic template="Default" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../helpproject.xsd">
  <title translate="true">Testing &amp; Debugging</title>
  <body>
    <header>
      <para styleclass="Heading1"><text styleclass="Heading1" translate="true">Testing &amp; Debugging</text></para>
    </header>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">Dolphin XP allows one to test and debug the COM components one has implemented in 3 different ways:</text></para>
    <list id="1" type="ol" listtype="decimal" formatstring="&#37;&#48;&#58;&#115;&#46;" levelreset="false" legalstyle="false" startfrom="1" styleclass="Normal" style="margin-left:24px; font-family:Arial; font-size:9pt; font-weight:bold; color:#000000;">
      <li styleclass="Normal" style="margin-left:24px;"><text styleclass="Program Feature" translate="true">In-image</text></li>
      <li styleclass="Normal" style="margin-left:24px;"><text styleclass="Program Feature" translate="true">In-process</text></li>
      <li styleclass="Normal" style="margin-left:24px;"><text styleclass="Program Feature" translate="true">Out-of-process</text></li>
    </list>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">When implementing a COM component in Dolphin, we can develop and test it easily and effectively within the same image. We refer to this as working</text><text styleclass="Class Name" translate="true">&#32;</text><text styleclass="Program Feature" translate="true">in-image</text><text styleclass="Normal" translate="true">. Ultimately, however, the point of COM is to permit language-independent, binary, component re-use, so eventually one will need to venture outside Dolphin and use an external client, connecting to a Dolphin server running either </text><text styleclass="Program Feature" translate="true">in-process</text><text styleclass="Normal" translate="true"> (as a DLL hosted in the client) or </text><text styleclass="Program Feature" translate="true">out-of-process</text><text styleclass="Normal" translate="true"> (as a separate executable). Even when using an external client one does not have to lose the advantages of image-based development.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">In both of the latter two cases a launcher stub is registered for the component that is then responsible for finding and loading the relevant development image. When loaded in-process the Dolphin development system will actually be running inside the host executable. When running out-of-process (or as a </text><text styleclass="Program Feature" translate="true">Local Server</text><text styleclass="Normal" translate="true"> in COM terminology) the development system will be launched as a separate executable. In either case the full range of development tools can be used, including the full facilities of the Debugger. One can set breakpoints in the implementation of a component</text><text styleclass="Normal" translate="true">’</text><text styleclass="Normal" translate="true">s public interface methods and have the Debugger launched when the client calls them. The client&apos;s thread will be suspended until Dolphin returns from the method. One can program in the debugger to flesh out the component implementation as it runs, refactor, evaluate expressions, and generally make any changes one desires as long as the COM interfaces being used by the client remain stable.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">In this section we will be using the “COM Random Stream” sample as our example. Before proceeding it is a good idea to try deploying this package as a DLL and running it inside the test VB client executable supplied with Dolphin XP Pro - see </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Deploying__Running_the_Random_Stream_Sample" styleclass="Normal" translate="true">Deploying &amp; Running the Random Stream Sample</link><text styleclass="Normal" translate="true">. Even if you do not follow all the steps to deploy and test the sample, you must ensure that at the very least the type library is registered in order that </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Marshalling" styleclass="Normal" translate="true">marshalling</link><text styleclass="Normal" translate="true"> support is available for the </text><text styleclass="Class Name" translate="true">IRandomStream</text><text styleclass="Normal" translate="true"> interface used in the sample.</text></para>
  </body>
</topic>
